<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>다시 만나서 반가워</title>
  <style>
    body {
    margin: 60px;
    padding: 0;
    overflow: hidden; /* 화면 밖으로 나가지 않도록 */
}

.SSAM {
    position: absolute;
    top: 100px;
    left: 606px;
    width: 300px;
    height: 120px;
    background-color: white;
    border: 2px solid #000;
}

.container1, .container2, .container3 {
    display: flex;
    flex-wrap: wrap;  /* 자동 줄 바꿈 */
    gap: 10px;        /* 요소 간 간격 */
    position: absolute;
    top: 302px;       /* 첫 번째 박스 위치 */
    width: 400px;     /* 전체 가로 폭 */
    height: 90px;
}

.container2 {
    left: 549px;
}

.container3 {
    left: 1016px;
}

.number {
    width: calc(50% - 10px); /* 한 줄에 두 개씩 배치 */
    height: 90px;
    background-color: white;
    border: 2px solid #000;
}

.name {
    width: 63px;
    height: 20px;
    border: 2px dotted #000; /* 점선 스타일의 테두리 */
    position: absolute;
    top: 0;
    left: 0;
    cursor: grab;  /* 초기 상태에서 잡을 수 있음을 표시 */
    transition: left 0.1s, top 0.1s; /* 움직일 때 부드러운 애니메이션 */
}

</style>

</head>

<body>
  
  
    <div class="SSAM"></div>
    <div class="container1">
        <div class="number" id="no1"></div> <!-- 첫 번째 박스 -->
        <div class="number" id="no2"></div> <!-- 두 번째 박스 -->
        <div class="number" id="no3"></div> <!-- 세 번째 박스 -->
        <div class="number" id="no4"></div> <!-- 네 번째 박스 -->
        <div class="number" id="no5"></div> <!-- 다섯 번째 박스 -->
        <div class="number" id="no6"></div> <!-- 여섯 번째 박스 -->
        <div class="number" id="no7"></div> <!-- 일곱 번째 박스 -->
        <div class="number" id="no8"></div> <!-- 여덟 번째 박스 -->
    </div>

    <div class="container2">
      <div class="number" id="no9"></div> <!-- 첫 번째 박스 -->
      <div class="number" id="no10"></div> <!-- 두 번째 박스 -->
      <div class="number" id="no11"></div> <!-- 세 번째 박스 -->
      <div class="number" id="no12"></div> <!-- 네 번째 박스 -->
      <div class="number" id="no13"></div> <!-- 다섯 번째 박스 -->
      <div class="number" id="no14"></div> <!-- 여섯 번째 박스 -->
      <div class="number" id="no15"></div> <!-- 일곱 번째 박스 -->
      <div class="number" id="no16"></div> <!-- 여덟 번째 박스 -->
    </div>

    <div class="container3">
      <div class="number" id="no9"></div> <!-- 첫 번째 박스 -->
      <div class="number" id="no10"></div> <!-- 두 번째 박스 -->
      <div class="number" id="no11"></div> <!-- 세 번째 박스 -->
      <div class="number" id="no12"></div> <!-- 네 번째 박스 -->
      <div class="number" id="no13"></div> <!-- 다섯 번째 박스 -->
      <div class="number" id="no14"></div> <!-- 여섯 번째 박스 -->
      <div class="number" id="no15"></div> <!-- 일곱 번째 박스 -->
      <div class="number" id="no16"></div> <!-- 여덟 번째 박스 -->
    </div>

    <div class="name"></div> <!-- 점선 상자 -->

    <div id="centralText"></div>
    <div class="name" data-message="언제는 애들이랑 몰래 짜장면도 시켜 먹었잖아. 그러다가 다같이 장염걸리고."></div>
    <div class="name" data-message="급식 안 먹고 라면 먹다가 걸려서 선도부 언니들이 쫓아왔던 것도 기억나. 학교 건물이랑 지하로 가는 길 사이 작은 통로에서 일렬로 쭉 서서 숨어있었는데. 그때 진짜 재미있었어. "></div>
    <div class="name" data-message="3학년 땐 학교 전체를 미친듯이 뛰어다니면서 술래잡기도 했잖아. 그때 화장실에서 너 놀래키려고 변기 위에 올라갔다가 변기에 발도 빠졌었어"></div>
    <div class="name" data-message="난 그것도 기억나. 누가 가정시간에 화장실 가려고 하는데 선생님이 안 보내주셔서 저 화장실 가고싶다구요! 이러면서 소리치고 화장실로 달려갔었는데……"></div>
    <div class="name" data-message="역사쌤이 수업 도중에 우셨잖아... 우리가 너무 짓궂게 굴어서..."></div>
    <div class="name" data-message="나 중학생 때 머리 엄청 짧았잖아. 3mm 투블럭. 그때 나 학교에서 인기가 엄청 많았던 거 같아."></div>
    <div class="name" data-message="난 1학년 때 3학년 언니가 너무 좋아서 졸졸 따라다녔어."></div>
    <div class="name" data-message="우리 학교에 있던 남자 쌤들 중에 누구 팬인지 인기 투표를 했던 것도 생각나."></div>
    <div class="name" data-message="보건쌤 기억나? 페미니즘 동아리 선생님! 나 그 선생님 진짜 좋아했어."></div>
    <div class="name" data-message="학교에서 벚꽃놀이 했던 거 생각난다."></div>
    <div class="name" data-message="학교에 비파나무 있던 거 기억나? 선생님이 먹는 방법 알려주셨는데. 진짜 맛있었어."></div>
    <div class="name" data-message="밤 주울려고 학교 뒷산에 올라갔던거 기억나?"></div>
    <div class="name" data-message="난 매점 무서웠어. 무서운 언니들이 매점 안에 소파에 앉아있었잖아."></div>
    <div class="name" data-message="축제 때 노래 부르고 인기 엄청 많았어 나."></div>
    <div class="name" data-message="밴드부 선생님 좋았었는데. 기억나? 너한테 편지 써주신 분."></div>
    <div class="name" data-message="우리 조퇴증 위조해서 밖에 나갔었잖아. 대박."></div>
    <div class="name" data-message="나 피구부 애들 진짜 무서워했는데... 공을 너무 무섭게 던져서..."></div>
    <div class="name" data-message="음악실에서 창 밖을 보면 바다가 보였어. 너무 예뻤는데."></div>
    <div class="name" data-message="학교 오는 길에 보이던 매화나무가 생각나."></div>
    <div class="name" data-message="교실에서 교복 바지 입고 춤추다가, 바지 찢어졌던 적도 있어 진짜 웃겼는데"></div>
    <div class="name" data-message="어떤 언니가 나한테 '사랑해'로 가득한 편지를 써서 줬어 "></div>
    <div class="name" data-message="쉬는 시간 3분 만에 매점 엄청 뛰어갔다 왔잖아. 어떻게 한 거지."></div>
    <div class="name" data-message="그 때의 내가 조금 더 당당했어."></div>
    <div class="name" data-message="난 매점에서 소세지 먹는 게 제일 좋았어."></div>
    <div class="name" data-message="여중 때 이후로 많은 사람들 앞에 섰던 적이 없던 것 같아."></div>


  <script>
    let currentDrag = null;
let draggedBox = null;
let textClickCount = 0; // 텍스트 클릭 횟수
let isIntroActive = true; // "너 누구야?" 메시지 활성화 상태
let introTriggered = false; // "너 누구야?" 메시지가 이미 표시되었는지 확인
let secondMessageTriggered = false; // "아! 미진이구나!" 메시지가 표시되었는지 확인

const dottedBoxes = document.querySelectorAll('.name');
const smallBoxes = document.querySelectorAll('.number');

// 페이지 전체에서 점선 네모가 겹치지 않는 랜덤 위치 생성
function getRandomPosition() {
    const maxWidth = window.innerWidth;
    const maxHeight = window.innerHeight;

    return {
        left: Math.random() * (maxWidth - 100),
        top: Math.random() * (maxHeight - 100)
    };
}

// 초기화: 점선 네모를 페이지 전체에서 랜덤 위치로 배치
dottedBoxes.forEach((box) => {
    const { left, top } = getRandomPosition();
    box.style.position = 'absolute';
    box.style.left = `${left}px`;
    box.style.top = `${top}px`;
});

// "너 누구야?" 메시지 표시
function showIntroText() {
    if (introTriggered) return;
    introTriggered = true;

    const introText = document.createElement('div');
    introText.innerText = '너 누구야?';
    introText.style.position = 'fixed';
    introText.style.top = '47%';
    introText.style.left = '50%';
    introText.style.transform = 'translate(-50%, -50%)';
    introText.style.fontSize = '16px';
    introText.style.color = 'black';
    introText.style.backgroundColor = 'rgba(255, 255, 255, 10';
    introText.style.padding = '10px';
    introText.style.border = '1.5px solid black';
    introText.style.zIndex = '1000';
    
    document.body.appendChild(introText);

    setTimeout(() => {
        introText.remove();
        isIntroActive = false; // 드래그 활성화
        showSecondMessageListener(); // 두 번째 메시지 대기
    }, 5000);
}

// "아! 미진이구나!" 메시지 표시
function showSecondMessage() {
    if (secondMessageTriggered) return;
    secondMessageTriggered = true;

    const secondText = document.createElement('div');
    secondText.innerText = '아! 미진이구나! 들어와!';
    secondText.style.position = 'fixed';
    secondText.style.top = '47%';
    secondText.style.left = '50%';
    secondText.style.transform = 'translate(-50%, -50%)';
    secondText.style.fontSize = '16px';
    secondText.style.color = 'black';
    secondText.style.backgroundColor = 'rgba(255, 255, 255,10)';
    secondText.style.padding = '10px';
    secondText.style.border = '1.5px solid black';
    secondText.style.zIndex = '1000';
    document.body.appendChild(secondText);

    setTimeout(() => {
        secondText.remove();
    }, 5000);
}

// 첫 번째 메시지 대기
function attachIntroListener() {
    const triggerEvents = ['mousemove', 'click', 'keydown'];
    triggerEvents.forEach((event) => {
        document.addEventListener(event, showIntroText, { once: true });
    });
}

// 두 번째 메시지 대기
function showSecondMessageListener() {
    const triggerEvents = ['mousemove', 'click', 'keydown'];
    triggerEvents.forEach((event) => {
        document.addEventListener(event, showSecondMessage, { once: true });
    });
}

// 점선 네모 드래그 시작
dottedBoxes.forEach((box) => {
    box.addEventListener('mousedown', (e) => {
        if (isIntroActive) return; // "너 누구야?" 표시 중이면 동작 안함
        currentDrag = box;
        draggedBox = box; // 드래그된 상자 추적
        currentDrag.style.zIndex = '1000';
    });
});

// 점선 네모 드래그 이동
document.addEventListener('mousemove', (e) => {
    if (isIntroActive || !currentDrag) return;
    currentDrag.style.position = 'absolute';
    currentDrag.style.left = `${e.pageX - currentDrag.offsetWidth / 2}px`;
    currentDrag.style.top = `${e.pageY - currentDrag.offsetHeight / 2}px`;
});

// 점선 네모 드래그 종료 및 작은 상자와의 충돌 체크
document.addEventListener('mouseup', (e) => {
    if (isIntroActive || !currentDrag) return;

    let isOverlapping = false;

    // 작은 상자들과 겹치는지 확인
    smallBoxes.forEach((smallBox) => {
        const smallBoxRect = smallBox.getBoundingClientRect();
        const dragRect = currentDrag.getBoundingClientRect();

        if (
            dragRect.left < smallBoxRect.right &&
            dragRect.right > smallBoxRect.left &&
            dragRect.top < smallBoxRect.bottom &&
            dragRect.bottom > smallBoxRect.top
        ) {
            isOverlapping = true;
        }
    });

    if (isOverlapping) {
        // 작은 상자와 겹칠 경우 메시지 표시
        const message = document.createElement('div');
        message.innerText = currentDrag.dataset.message; // 점선 네모에 설정된 메시지
        message.style.position = 'fixed';
        message.style.top = '95%';
        message.style.left = '50%';
        message.style.transform = 'translate(-50%, -50%)';
        message.style.color = 'black';
        message.style.fontSize = '16px';
        message.style.zIndex = '1000';
        document.body.appendChild(message);

        // 메시지 표시 후 투명화
        setTimeout(() => {
            let opacity = 1;
            const fadeInterval = setInterval(() => {
                opacity -= 0.05;
                message.style.opacity = opacity;
                draggedBox.style.opacity = opacity;

                if (opacity <= 0) {
                    clearInterval(fadeInterval);
                    message.remove();
                    draggedBox.remove();
                }
            }, 100);
        }, 4000);

        // 클릭 횟수 증가
        textClickCount++;

        // 특정 클릭 횟수에 따라 버튼 생성
        if (textClickCount === 5) {
            createButton('야! 이 얘기 들었어?');
        } else if (textClickCount === 7) {
            updateButtonText('야! 들었냐고!');
        } else if (textClickCount === 10) {
            updateButtonText('아니 좀 들어봐 봐');
        }
    }

    currentDrag = null; // 드래그 상태 초기화
});

// 버튼 생성 함수
function createButton(text) {
    const button = document.createElement('button');
    button.innerText = text;
    button.style.position = 'fixed';
    button.style.top = '50%';
    button.style.left = '50%';
    button.style.transform = 'translate(-50%, -50%)';
    button.style.padding = '10px 20px';
    button.style.fontSize = '16px';
    button.style.backgroundColor = 'white';
    button.style.color = 'black';
    button.style.border = '1px solid black';
    button.style.zIndex = '1000';
    document.body.appendChild(button);

    button.addEventListener('click', () => {
        const square = document.createElement('div');
        square.style.position = 'fixed';
        square.style.top = '50%';
        square.style.left = '50%';
        square.style.transform = 'translate(-50%, -50%)';
        square.style.width = '400px';
        square.style.height = '200px';
        square.style.backgroundColor = 'white';
        square.style.border = '2px solid black';
        square.style.color = 'black';
        square.style.textAlign = 'center'; // 글자 가운데 정렬
        square.style.padding = '20px';
        square.style.fontSize = '16px';
        square.style.zIndex = '1000';
        square.innerHTML = `
            <p>우리 학교 공학으로 바뀐대.</p>
            <p>그러면 옆학교랑 이름이 같아서 학교 이름도 바꿔야 한대.</p>
            <p>그럼 난 이제 출신도 바뀌는거야.</p>
            <p>난 원래 이름이 더 좋은데.</p>
            <p>슬프다. 이제 우리는 없어지네.</p>
        `;
        document.body.appendChild(square);

        button.remove(); // 버튼 제거
    });
}

function updateButtonText(newText) {
    const button = document.querySelector('button');
    if (button) {
        button.innerText = newText;
    }
}

// 첫 번째 메시지 대기
attachIntroListener();
  </script>
</body>


</html>
